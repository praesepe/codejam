For loop instead of recursive to speedup.