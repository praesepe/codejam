(king) Small ok version with history cache.